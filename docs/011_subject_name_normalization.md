# 科目名正規化実装

## 📅 実施日時
2025-08-27 17:05

## 🎯 目的
科目名の表記揺れを統一し、データの一貫性を確保する

## 📋 正規化ルール
1. **西洋数字を使用**: I, II（ローマ数字 Ⅰ, Ⅱ は使わない）
2. **スペースを挿入**: I, II の前には必ずスペースを入れる
3. **個別エントリ化**: I/II 形式は I と II の別々のエントリに分割

## 🔍 現状分析

### ✅ 修正済み
- `キャリア実践I` → `キャリア実践 I`（スペース追加）

### ⚠️ 要対応：I/II 形式の分割が必要な科目

#### 1. クリエイティブコミュニケーションラボ I/II
- **現状**: 合併エントリのみ（id: s1）
- **必要な対応**: I と II を別エントリ化
- **特記事項**: 全学年合同授業、鈴木先生担当

#### 2. SNS/PR実践 I/II
- **現状**: 合併エントリのみ（id: s38）
- **必要な対応**: I と II を別エントリ化
- **特記事項**: TD専門、廣瀬先生担当

#### 3. 地域課題実践プロジェクト I/II
- **現状**: 合併エントリのみ（id: s39）
- **必要な対応**: I と II を別エントリ化
- **特記事項**: TD専門、久保先生担当

#### 4. 次世代地域リーダー学 I/II（合同）
- **現状**: 合併エントリ（id: s2）と個別エントリ（s3: I, s4: II）が両方存在
- **必要な対応**: 合併エントリを削除またはコメントアウト
- **特記事項**: 井手先生担当、11/28(金)3限固定

## 🛠️ 実装内容

### 1. 正規化ユーティリティ作成
`/src/utils/subjectNameNormalizer.ts`を作成：
- `normalizeSubjectName()`: 科目名を正規化
- `splitCombinedSubject()`: I/II形式を分割
- `isNormalizedSubjectName()`: 正規化チェック
- `reportNormalizationStatus()`: 正規化レポート生成

### 2. データ修正計画

#### Phase 1: 即座に修正可能（実施済み）
- ✅ キャリア実践I → キャリア実践 I

#### Phase 2: 構造変更が必要
以下の科目は I/II を分割して個別エントリ化が必要：

1. **クリエイティブコミュニケーションラボ**
   - 新規作成: s1a (I), s1b (II)
   - 削除: s1

2. **SNS/PR実践**
   - 新規作成: s38a (I), s38b (II)
   - 削除: s38

3. **地域課題実践プロジェクト**
   - 新規作成: s39a (I), s39b (II)
   - 削除: s39

4. **次世代地域リーダー学**
   - 既存: s3 (I), s4 (II)を使用
   - 削除: s2（合併版）

## ⚠️ 影響範囲

### 影響を受けるコンポーネント
1. **SubjectManager.tsx**: 科目一覧表示
2. **autoScheduleGenerator.ts**: スケジューリングロジック
3. **TimetableGrid.tsx**: 時間割表示
4. **ExportButtons.tsx**: Excel/PDF出力

### 必要な追加対応
1. **科目ID参照の更新**: 分割後の新IDへの参照変更
2. **コンビ授業の再設定**: 必要に応じてcomboSubjectIdの更新
3. **教師割り当ての確認**: teacherIdsの整合性確認

## 📝 実装手順

### Step 1: バックアップ（完了）
現在のmockData.tsの状態を記録

### Step 2: データ正規化（一部完了）
- ✅ キャリア実践 I のスペース修正

### Step 3: I/II分割実装（次のステップ）
1. 新規エントリの作成
2. 旧エントリのコメントアウト
3. ID参照の更新

### Step 4: 動作確認
1. アプリケーション起動確認
2. 科目一覧の表示確認
3. スケジューリング動作確認
4. Export機能の確認

## 🚨 リスク評価
- **低リスク**: 表示のみの変更（スペース追加）
- **中リスク**: I/II分割によるID変更（参照整合性の確認必要）
- **対策**: 段階的実装とテストによる確認

## 📊 期待される効果
1. **データ一貫性向上**: 表記揺れの解消
2. **保守性向上**: 明確な命名規則
3. **将来の拡張性**: I と II の個別管理が可能
4. **Googleフォーム連携**: 正規化されたデータでの自動処理が容易

---
*次のアクション: I/II形式の科目分割実装*